package com.behl.malware.detector;

import org.jetbrains.annotations.NotNull;
import com.amazonaws.SdkClientException;
import com.amazonaws.auth.DefaultAWSCredentialsProviderChain;
import com.amazonaws.regions.Regions;
import com.amazonaws.services.s3.AmazonS3;
import com.amazonaws.services.s3.AmazonS3ClientBuilder;
import com.amazonaws.services.s3.model.S3Object;

public class S3Service {

  private S3Service() {}

  public static S3Object getObject(@NotNull final String bucketName,
      @NotNull final String objectKey) {
    S3Object s3Object;
    try {
      s3Object = getS3Client().getObject(bucketName, objectKey);
    } catch (final SdkClientException exception) {
      throw new RuntimeException("Exception occurred while fetching object from S3.", exception);
    }
    return s3Object;
  }

  private static AmazonS3 getS3Client() {
    return AmazonS3ClientBuilder.standard()
        .withCredentials(new DefaultAWSCredentialsProviderChain()).withRegion(Regions.AP_SOUTH_1)
        .build();
  }

}
